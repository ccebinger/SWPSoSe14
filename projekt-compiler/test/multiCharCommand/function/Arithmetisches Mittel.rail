$ 'main' (--):
 \
  \
   \                                                     /------------------------------------------------\
    \                                                    |                                                | 
     \                                                   |      /----(!in!)-(!count!)-(count)-1-a-(in)i-a-/
      \                                                  \     /
       \         /--i-2-(!count!)-(!in!)-(count)-(in)-i-a----e<
        \       /                                              \  
         \---e-<                                                \------{arith}--#
                \
                 \-----#


$ 'arith'(--):
 \
  \ 
   \
    \
     \------(!in!)--(!count!)-(in)-(count)-d---o#                    